package com.aantik.demo.cargaUsuarios;

import java.io.IOException;
import java.io.InputStream;
import java.util.Iterator;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import com.aantik.demo.model.Mpreinscrito;

public class leerEstudiantes {
	
	  public void getPreinscritos(InputStream is, Mpreinscrito[] lista) {
		  	String actividad= null;
		  	try {
		    Workbook workbook = new XSSFWorkbook(is);
		      Sheet sheet = workbook.getSheetAt(0);
		      Iterator<Row> rows = sheet.iterator();
		      Sheet sheet2=workbook.getSheetAt(0);   //getting the XSSFSheet object at given index  
			  int colNumber = sheet2.getRow(1).getPhysicalNumberOfCells();
		      System.out.println("xcol: "+colNumber);	   
		      int rowNumber = 0;
		      int rowDatos=0;
		      while (rows.hasNext()) {
		    	int cellIdx = 0;
		        // skip header
		    	lista[rowDatos]=new Mpreinscrito();
		        rowNumber++;
		        Row row=sheet2.getRow(rowNumber);  //returns the logical row      
		          if(row==null) {
		        	  break;
		          }
		        Cell cell; 
		        String value2;
		        	  for(int i=1;i<11;i++) {
			          cell=row.getCell(i);

			          if(cell!=null) {
			        		  if(cell.getCellType()==XSSFCell.CELL_TYPE_NUMERIC)
				        	  value2= String.valueOf(cell.getNumericCellValue());
				          else
					  	      value2= String.valueOf(cell.getStringCellValue());
				          if(value2.length()!=0 && value2!=null) {
				        	  System.out.println("valor ="+value2);
					       /* 	  lista[rowDatos].nombre=row.getCell(1).getStringCellValue();
					        	  lista[rowDatos].correo=row.getCell(2).getStringCellValue();
					        	  lista[rowDatos].telefono=row.getCell(3).getStringCellValue();
					        	  lista[rowDatos].direccion=row.getCell(4).getStringCellValue();
					        	  lista[rowDatos].asignatura=row.getCell(5).getStringCellValue();
					        	  lista[rowDatos].idEstudiantil=(long)(row.getCell(6).getNumericCellValue());
					        	  lista[rowDatos].identificacion=(long)(row.getCell(7).getNumericCellValue());
					        	  lista[rowDatos].tallerSP=row.getCell(8).getStringCellValue();
					        	  lista[rowDatos].fechaSP=row.getCell(9).getStringCellValue();
					        	  lista[rowDatos].infografia=row.getCell(10).getStringCellValue();
					        	  System.out.println(" "+lista[rowDatos].nombre+" "+lista[rowDatos].correo+" "+
					        			  lista[rowDatos].telefono+" "+lista[rowDatos].direccion+" "+
					        			  lista[rowDatos].asignatura+" "+lista[rowDatos].idEstudiantil+
					        			  " "+lista[rowDatos].identificacion+" "+lista[rowDatos].tallerSP
					        			  +" "+lista[rowDatos].fechaSP+" "+lista[rowDatos].infografia);
					        	  rowDatos++; */
				          }	
			        	 }
				          
				          
			          }	        	  
			          cellIdx++;			                	
		      }

	    	//  System.out.println("CLOSE: "+rowDatos);	
    		return;// rowDatos;
		    } catch (IOException e) {
		      throw new RuntimeException("fail to parse Excel file: " + e.getMessage());
		    }
		  }
}
